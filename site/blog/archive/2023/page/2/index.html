
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="关于软件、Geek | Ray，Web & Mobile Lover，Software Engineer | 这里是 @Ray睿 类喵星人的个人博客。专注求索，创新">
      
      
        <meta name="author" content="Ray-X">
      
      
        <link rel="canonical" href="https://rayx.me/blog/archive/2023/page/2/">
      
      
        <link rel="prev" href="../../../2024/">
      
      
        <link rel="next" href="../../../2022/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>2023 - Ray-X</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.7e359304.min.css">
      
      


  
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
  
  <style>.md-tag.md-tag--css{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1.5 0h21l-1.91 21.563L11.977 24l-8.565-2.438L1.5 0zm17.09 4.413L5.41 4.41l.213 2.622 10.125.002-.255 2.716h-6.64l.24 2.573h6.182l-.366 3.523-2.91.804-2.956-.81-.188-2.11h-2.61l.29 3.855L12 19.288l5.373-1.53L18.59 4.414z"/></svg>');}.md-tag.md-tag--html{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1.5 0h21l-1.91 21.563L11.977 24l-8.564-2.438L1.5 0zm7.031 9.75-.232-2.718 10.059.003.23-2.622L5.412 4.41l.698 8.01h9.126l-.326 3.426-2.91.804-2.955-.81-.188-2.11H6.248l.33 4.171L12 19.351l5.379-1.443.744-8.157H8.531z"/></svg>');}.md-tag.md-tag--js{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"/></svg>');}.md-tag.md-tag--python{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.25.18.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"/></svg>');}</style>

    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2023" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Ray-X" class="md-header__button md-logo" aria-label="Ray-X" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ray-X
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2023
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ray-x" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-x
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Ray-X" class="md-nav__button md-logo" aria-label="Ray-X" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5Z"/></svg>

    </a>
    Ray-X
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ray-x" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-x
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whats new
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    latest
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            latest
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/12/20/asyncio-python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asyncio python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/12/19/python-django-restful-framework/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Django Restful Framework
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="2023">2023<a class="headerlink" href="#2023" title="Permanent link">&para;</a></h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2023-12-19 00:00:00">December 19, 2023</time>
          <!-- start customization -->
          
          <!-- end customization --></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="python-310"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/">Python 3.10</a></h2>
<h3 id="structural-pattern-matching-python-version-of-switch"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#structural-pattern-matching-python-version-of-switch">Structural Pattern Matching, python version of <code>switch</code></a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">respond</span><span class="p">(</span><span class="n">language</span><span class="p">):</span>
    <span class="k">match</span> <span class="n">language</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;Java&quot;</span> <span class="o">|</span> <span class="s2">&quot;Javascript&quot;</span><span class="p">:</span>  <span class="c1"># multiple pattern match</span>
            <span class="k">return</span> <span class="s2">&quot;Love those braces!&quot;</span>
        <span class="k">case</span> <span class="s2">&quot;Python&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;I&#39;m a lumberjack and I don&#39;t need no braces&quot;</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>  <span class="c1">#default</span>
            <span class="k">return</span> <span class="s2">&quot;I have no clue!&quot;</span>
</code></pre></div>
<h4 id="we-could-match-against-one-or-more-literals-by-using-the-or-pattern"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#we-could-match-against-one-or-more-literals-by-using-the-or-pattern">We could match against one or more literals by using the OR pattern <code>|</code></a></h4>
<h3 id="capturing-match"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#capturing-match">Capturing match</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">op</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
    <span class="k">match</span> <span class="n">command</span><span class="p">:</span>
        <span class="k">case</span> <span class="p">[</span><span class="s2">&quot;move&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;F&quot;</span> <span class="o">|</span> <span class="s2">&quot;B&quot;</span> <span class="o">|</span> <span class="s2">&quot;L&quot;</span> <span class="o">|</span><span class="s2">&quot;R&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">direction</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">symbols</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>
        <span class="k">case</span> <span class="s2">&quot;pick&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;pick&quot;</span><span class="p">]</span>
        <span class="k">case</span> <span class="s2">&quot;drop&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">symvols</span><span class="p">[</span><span class="s2">&quot;drop&quot;</span><span class="p">]</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2"> does not compute!&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="it-match-move-f-move-b-move-l-move-r"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#it-match-move-f-move-b-move-l-move-r">It match <code>"move F"</code>, <code>"move B"</code> <code>"move L"</code> <code>"move R"</code></a></h4>
<h2 id="union"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#union">*union* ~|~</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">s1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">}</span>
<span class="n">s2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">}</span>

<span class="n">s1</span> <span class="o">|</span> <span class="n">s2</span> <span class="c1">#[[{&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;}]]</span>

<span class="n">d1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">d2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="n">d1</span> <span class="o">|</span> <span class="n">d2</span>  <span class="c1"># {&#39;c&#39;: 3, &#39;d&#39;: 40, &#39;a&#39;: 1, &#39;b&#39;: 2}</span>
</code></pre></div>
<h2 id="assignment-expressions"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#assignment-expressions">assignment expressions <code>:=</code></a></h2>
<h3 id="it-assign-value-and-return-the-values"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#it-assign-value-and-return-the-values">it assign value and return the values</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">x</span><span class="o">:=</span><span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># output 4 and x=4</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">:=</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># same as a=x=30</span>
</code></pre></div>
<h3 id="examples"><a class="toclink" href="../../../../2023/12/19/whats-new-in-python-310/#examples">examples</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">even_results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">result</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">:=</span> <span class="n">slow_function</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
<span class="p">]</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">even_random</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">:=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">number</span> <span class="o">:=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">number</span>
</code></pre></div>
<p>*</p>
    <nav class="md-post__action">
      <a href="../../../../2023/12/19/whats-new-in-python-310/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2023-12-19 00:00:00">December 19, 2023</time>
          <!-- start customization -->
          
          <!-- end customization --></li>
        
        
          
          <li class="md-meta__item">
            
              19 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="python-basic"><a class="toclink" href="../../../../2023/12/19/python-basic/">python basic</a></h2>
<ul>
<li><a href="../assets/Python+Deep+Dive+1_1694868717879_0.pdf">Python+Deep+Dive+1.pdf</a></li>
<li>Refresher<ul>
<li>Multi-line Statement in Python:<ul>
<li>To extend the statement to one or more lines we can use braces {}, parentheses (), square [], semi-colon “;”, and continuation character slash “\”.</li>
<li>For string you can use <code>'''</code> or <code>"""</code> for a multiple line string
  <div class="highlight"><pre><span></span><code><span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span>
        <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
        <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initializing a list using the</span><span class="se">\</span>
<span class="s1"> Implicit multi-line statement&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;geeks</span>
<span class="s2">for</span>
<span class="s2">geeks&quot;&quot;&quot;</span>
<span class="c1"># Initializing a mathematical expression</span>
<span class="c1"># using the Implicit multi-line statement.</span>
<span class="n">add</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span> <span class="o">+</span>
       <span class="mi">40</span> <span class="o">-</span>
       <span class="mi">52</span><span class="p">)</span>
<span class="k">if</span> <span class="n">a</span> \
  <span class="ow">and</span> <span class="n">b</span><span class="p">:</span>
  <span class="k">pass</span>
</code></pre></div></li>
</ul>
</li>
<li>Variable Naming<ul>
<li>((6505ac52-5d0c-4272-8c97-ea3ab05e7dcd))</li>
</ul>
</li>
<li>Condition Expression<ul>
<li><code>5 &lt; a &lt; 7</code> vs <code>5&lt;a and a&lt;7</code></li>
<li>ternary<ul>
<li><code>b = 1 if a &lt; 5 else 2</code></li>
<li><code>var = exp1 if con-exp2 else exp2</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Continue, break, while, else, try, catch, finally</p>
<ul>
<li>The <code>continue</code> statement skips the current iteration of a loop and continues with the next iteration.</li>
<li><code>finally</code> will be executed even with <code>continue|break</code></li>
<li>loop altogether, and the program continues after the loop. aka <code>goto loop_exit</code></li>
<li>Inside try-except-finally</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="c1"># in a for Statement</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;trying...&#39;</span><span class="p">)</span>
      <span class="k">continue</span>   <span class="c1">#break</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;still trying...&#39;</span><span class="p">)</span>
  <span class="k">except</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Something went wrong.&#39;</span><span class="p">)</span>
  <span class="k">finally</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loop ended.&#39;</span><span class="p">)</span>
<span class="c1"># Prints trying...</span>
<span class="c1"># Prints Done!</span>
<span class="c1"># Prints trying...</span>
<span class="c1"># Prints Done!</span>
<span class="c1"># Prints Loop ended.</span>
</code></pre></div>
- finally clause is executed before starting(break; exit) the next iteration.
- <code>break</code> with <code>for/while-else</code>
    - If the loop terminates <strong>prematurely</strong> with <code>break</code>, the else clause won’t be executed.</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span>```<span class="w"> </span><span class="nv">python</span>
<span class="w">  </span>#<span class="w"> </span><span class="k">Break</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="s1">&#39;blue&#39;</span>
<span class="w">  </span><span class="nv">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="s1">&#39;red&#39;</span>,<span class="w"> </span><span class="s1">&#39;green&#39;</span>,<span class="w"> </span><span class="s1">&#39;blue&#39;</span>,<span class="w"> </span><span class="s1">&#39;yellow&#39;</span>]
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">colors</span>:
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;blue&#39;</span>:
<span class="w">          </span><span class="k">break</span>
<span class="w">      </span><span class="nv">print</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>
<span class="w">  </span><span class="k">else</span>:
<span class="w">      </span><span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;Done!&#39;</span><span class="ss">)</span><span class="w"> </span>#<span class="nv">will</span><span class="w"> </span><span class="nv">never</span><span class="w"> </span><span class="nv">executed</span>
<span class="w">  </span>#<span class="w"> </span><span class="nv">Prints</span><span class="w"> </span><span class="nv">red</span><span class="w"> </span><span class="nv">green</span>
<span class="w">  </span>```
</code></pre></div>

<ul>
<li>Variable<ul>
<li><em>Everything</em> is object</li>
</ul>
</li>
<li>e.g. int is <Class 'int'><ul>
<li>Python Garbage Collection</li>
</ul>
</li>
<li>Viewing reference counts in Python</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;my-string&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">a</span>  <span class="c1"># set ref count to 0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gc</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="p">(</span><span class="mi">595</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="mi">577</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gc</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
- Disabling the garbage collector
    - <a href="https://instagram-engineering.com/dismissing-python-garbage-collection-at-instagram-4dca40b29172">Dismissing Python Garbage Collection at Instagram | by Instagram Engineering | Instagram Engineering</a>
    - When share memory or object reused repeatedly disable GC can save
- Python object id() is used to get location of a object
    - Type
- Python is Dynamic typed, use <code>type()</code> to get object type
- Python access variable data value through reference. Object can bind to different type (change reference) durning execution
    - Mutable vs immutable
- ((650790fd-e50a-4807-9705-97324dbb967b))
- Inmutable: create a new object if value changed, <code>id(my_var)</code> changes when value changed.
- Why it is important?
    - Side-effect
    - performance
- Notes
    - mutable can change id. E.g. <code>list.appen(val)</code> vs <code>list += [val]</code> vs <code>list = list+[val]</code>. The last <code>list=list+[val]</code> creates a new object
    - use <code>append</code> or <code>+=</code> when possible
    - A immutable object can have mutable objects</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="err">```</span><span class="w"> </span><span class="n">python</span>
<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="w">  </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">  </span><span class="err">```</span>
<span class="o">-</span><span class="w"> </span><span class="n">immutable</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">unintended</span><span class="w"> </span><span class="n">side</span><span class="o">-</span><span class="n">effect</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="k">func</span><span class="w"> </span><span class="n">call</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">side</span><span class="o">-</span><span class="n">effect</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">copy</span><span class="p">()</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">shallow</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">mutable</span><span class="w"> </span><span class="n">object</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">list</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Share</span><span class="w"> </span><span class="n">reference</span>
</code></pre></div>

<ul>
<li>python share reference by default
  ((65079bf5-d1fd-48ef-aa24-680ec28b97cd))</li>
<li>With mutable objects e.g. list, Python will <strong>NEVER</strong> create shared reference. This may confusing with</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">b</span><span class="o">=</span><span class="n">a</span> <span class="c1">#reference</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1">#does not share with a/[1,2]</span>
</code></pre></div>
- Python pr-create values [-5, 256] so if value in that range, it will share reference
    - Equality
- <code>is</code> identity operator <code>id(a) == id(b)</code>
- Sample</p>
<p><div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">a</span> <span class="ow">is</span> <span class="n">b</span>
<span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">b</span>
</code></pre></div>
- All objects of None are same. Same id and same value <code>a is None</code>
    - Numbers
- Python does handle allication memory/bytes for numbers based on the value, e.g. <span class="arithmatex">\(2^{1000}\)</span> use 160 bytes
- The larger the number the more memory
- <code>floor</code> is largest(in stardard number order)</p>
<p><div class="highlight"><pre><span></span><code><span class="n">floor</span><span class="p">(</span><span class="mf">3.3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="mi">3</span>
<span class="n">floor</span><span class="p">(</span><span class="o">-</span><span class="mf">3.3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="mi">4</span>
</code></pre></div>
    - <code>/</code> divide -&gt; float
    - <code>//</code> divide floor -&gt; int
    - <code>%</code> reminder -&gt; int
    - int(10.9)  -&gt; truncation 10
- Integer / int
    - constructor  <code>int(10.1); int(True); int(Decimal("10.2")); int("10")</code>
    - With Base. <code>int("1010", 2) ; int("1010", base=2)</code>
    - <code>bin() -&gt; "0b1010";  oct() -&gt; "0o12"; hex() -&gt; "0xa"</code>
    - <code>sign(x)</code>: <code>1 if x &gt;= 0 else -1</code>
- Rational and Fraction
    - Franction
        -
          <div class="highlight"><pre><span></span><code><span class="n">From</span> <span class="n">factions</span> <span class="kn">import</span> <span class="nn">Fraction</span>
<span class="n">Fraction</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>  <span class="c1">#3/4   numerartor, denominator</span>
<span class="n">Fraction</span><span class="p">(</span><span class="mf">3.4</span><span class="p">)</span>
<span class="n">Fraction</span><span class="p">(</span><span class="s1">&#39;3.4&#39;</span><span class="p">)</span>
<span class="n">Fraction</span><span class="p">(</span><span class="s1">&#39;3.4&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fraction</span><span class="p">(</span><span class="mf">3.4</span><span class="p">)</span>
<span class="n">Fraction</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># will be comn</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">y</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">y</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">6369051672525773</span><span class="p">,</span> <span class="mi">4503599627370496</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
        - use y.limit_{ denominator(10)} to round denominator to close to 10
- Float
    - IEEE 754 double-precision binary float aka binary 64
        - sing 1bit
        - exponent 11bit
        - significant 52 bit
    - Equality
        - <code>math.isclose(a, b, *, rel​​​​​_​​​​​​​tol=1e - 9, abs​​_​​tol=0.0)</code>
            - e.g. <code>math.isclose(3.3, 1+2.3000)</code>
        - <code>round(val, digits)</code>  e.g. <code>round(3.1415, 2)  -&gt; 3.14</code>
        - You should always use isclose for compare float
    - Float to int
        - <code>truncation|math.trunc()</code>, <code>floor</code>, <code>ceiling</code>, <code>rounding</code>
        - trunc keep the int part. same as <code>int(val)</code>
        - <code>floor</code> largest integer LE to the val
        - <code>ceiling</code>  min{i &gt;= x}
        - round(val, n). closest multiple of 10^{ -n} , n default to 0 so round(val) -&gt; int(val)
            - round(1.25, 1) -&gt; 1.2 (to nearest val with even least significant digit)
            - Banker&rsquo;s Rounding
- decimal
    - Unlike <a href="https://www.pythontutorial.net/advanced-python/python-float/">floats</a>, Python represents decimal numbers exactly. And the exactness carries over into arithmetic
    - Decimal always associates with a <a href="https://www.pythontutorial.net/advanced-python/python-context-managers/">context</a> that controls the following aspects:
        - Precision during an arithmetic operation (default 28)
        - Rounding algorithm
    - Sample</p>
<div class="codehilite"><pre><span></span><code>  <span class="err">```</span> <span class="n">python</span>
  <span class="kn">import</span> <span class="nn">decimal</span>
  <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
  <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">pi</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3.14159&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span> <span class="p">)</span>
  <span class="n">pi</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>
  <span class="n">pi</span> <span class="o">=</span> <span class="n">Decimal</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>

  <span class="mf">10.0</span> <span class="o">==</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;10.0&#39;</span><span class="p">)</span>  <span class="c1"># .0 will be use</span>
  <span class="mf">0.1</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span> <span class="c1">#  print(&#39;{:.20f}&#39;.format(0.1)) 0.10000000000000000555</span>
  <span class="err">```</span>
<span class="o">-</span> <span class="n">Decimal</span> <span class="n">arithmetic</span> <span class="n">operators</span>
    <span class="o">-</span> <span class="err">`</span><span class="o">//</span><span class="err">`</span> <span class="ow">and</span> <span class="err">`</span><span class="o">%</span><span class="err">`</span>
    <span class="o">-</span> <span class="err">`</span><span class="n">Decimal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="n">Decimal</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="err">`</span> <span class="o">-&gt;</span> <span class="err">`</span><span class="n">trunc</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="err">`</span>
</code></pre></div>

<ul>
<li>Complex number<ul>
<li>use <code>cmath</code></li>
<li>Boolean</li>
</ul>
</li>
<li>Boolean is subclass of <code>int</code> but it is used in totally different way. Every object in python has a <code>truth value</code> (truthiness)</li>
<li><code>bool</code> class<ul>
<li><code>True</code> and <code>False</code></li>
<li>isubclass of int <code>issubclass(bool, int)</code></li>
<li>wired truth of bool</li>
<li><code>isinstance(True, int)</code>  -&gt; <code>True</code></li>
<li>True -&gt; 1; False-&gt;0  (int(True)-&gt;1; True == 1 ; True &gt; False)<ul>
<li>True + True = 2</li>
</ul>
</li>
<li>They are singleton object</li>
<li>You can use both <code>a==True</code> and <code>a is True</code> because it is singleton</li>
</ul>
</li>
<li>Truthy<ul>
<li>All objects are True except<ul>
<li>None</li>
<li>False</li>
<li>classes implement <code>__bool__</code> or <code>__len__</code> that return <code>False</code> or <code>0</code>.
  Default of <code>__bool__</code> is <code>return self != 0</code>
  e.g. <code>bool(100)</code> will execute <code>int(100).__bool__()</code> and therefore return result of <code>100 != 0</code></li>
<li>Based on above following is <code>False</code>:<ul>
<li>0 <strong>in any numeric type</strong> (0, 0.0, 0+0j)</li>
<li>empty collections (list, tuple, string, dict set)</li>
</ul>
</li>
</ul>
</li>
<li>
<h3 id="for-javascript-650504dd-d2ad-48f6-b26b-b98d6c5e99dd"><a class="toclink" href="../../../../2023/12/19/python-basic/#for-javascript-650504dd-d2ad-48f6-b26b-b98d6c5e99dd">for [[javascript]] ((650504dd-d2ad-48f6-b26b-b98d6c5e99dd))</a></h3>
</li>
</ul>
</li>
<li>Logical operation precedence<ul>
<li>()</li>
<li>compare <code>&gt;, &lt; == !=</code></li>
<li><code>in</code> <code>is</code></li>
<li><code>and</code></li>
<li><code>or</code></li>
</ul>
</li>
<li>Short-Circuit<ul>
<li>Be care that when short-circuited, part of the expression may not executed</li>
</ul>
</li>
<li>
<p>Logic operations</p>
<ul>
<li>X or Y is equal to <code>X if X else Y</code></li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">7</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="ow">or</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># 32</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;abc&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="ow">or</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># abc</span>
</code></pre></div>
- <code>X and Y</code>   <code>X if not X else Y</code>
    -
      <div class="highlight"><pre><span></span><code>x = 10
y =  x and 20/x  # y = 2

z = (s and s[0]) or &#39;&#39;  # if s: return s[0]; else return &#39;&#39;
</code></pre></div>
        - Comparison operators
- chained comparisons
    - In Python, chaining comparison operators is a way to simplify multiple comparison operations by stringing them together using logical operators. This is also known as “chained comparisons” or “chained comparison operators”.
    - <code>a==b==c</code>
    - <code>a&lt;b&lt;c</code>
    - <code>a&lt;b&gt;c</code>
    - <code>a&gt;b&lt;c</code>
    - <code>a&lt;b&lt;c&lt;d</code>
    -
      <div class="highlight"><pre><span></span><code><span class="n">exp1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">e</span> <span class="ow">is</span> <span class="n">f</span>
</code></pre></div>
- Function
    - Argument and parameter
        - Positional and keyword arguments
- It following C++ rule. If a positional parameter is defined with default value, every positional parameter after it <strong>must</strong> given a default value</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">myfun</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="c1"># a positional</span>
  <span class="k">pass</span>
<span class="n">myfun</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">myfun</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">myfun</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div>
        - keyword argument
-
  <div class="highlight"><pre><span></span><code><span class="n">myfun</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">my</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">myfun</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#b skipped and will use default value of 100</span>
<span class="n">myfun</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># it is ok not follow same order</span>
<span class="n">myfun</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># ❌not correct, the rest after `a=1` must be named</span>
</code></pre></div>
        - Function arguments list is ((650994bb-61c3-4e01-b5a0-e7eeda531610))
- <code>*arg</code> to accept variable length arguments
    - example</p>
<div class="codehilite"><pre><span></span><code>  ``` python
  def func(a, b, c)
    pass
  l = [1, 2, 3]
  func(*l)  #unpack  l from list to numbers

  def func2(a, b, *args)
    print(a, b, args)
  func2(10, 20, 1, 2, 3)  # 10, 20 (1, 2, 3)

  def avg((args):
    return args and xxxxsum(args)/len(args)
  ```
<span class="k">-</span> all arguments after <span class="sb">`*arg`</span> must be ^^keyword^^ arugments

  ``` python
  def func2(a, b, <span class="gs">*args, d)</span>
<span class="gs">    print(a, b, args)</span>
<span class="gs">  func(1, 2, 3, 4, d=5)</span>
<span class="gs">  ```</span>
<span class="gs">- ^^*</span>^^ without name <span class="sb">`def func(*, d)`</span> means there are no more positional args, you must provides keyword arguments
    <span class="k">-</span> it means you can not pass arguments other than &lt;&lt;keyword argument&gt;&gt;
    <span class="k">-</span> e.g <span class="sb">`func(d=32)`</span>
<span class="k">-</span> ^^/^^ : <span class="sb">`def mod(x, y, /)`</span> means x, and y are &lt;&lt; position ONLY parameters &gt;&gt;
</code></pre></div>

<ul>
<li>
<p><code>**kwargs</code> to unpack dict</p>
<ul>
<li>used to group keywords arguments</li>
<li>can be spicified even if positional arguments not been exausted</li>
<li><strong>NO</strong> parameters can come after **kwargs</li>
<li>Sample</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="n">func</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># d=1, kwargs = {&#39;a&#39;: 2, &#39;b&#39;:3}</span>
<span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="n">func</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># (1, 2) {a:10, b:20}</span>
</code></pre></div>
- you <strong>can not</strong> do this: func(a, b, **, ***kwargs)
            - Default arguments #pitfall
- It created once, the value should be treat as const. If you need the argument to be variable, e.g. <code>datetime.now()</code> do not use default argument.
    - Solution: <ins>default to None</ins>
- Another case, if initialize a default parameter with collection (e.g. list, dict). As same reason above, it will freeze a collection object to variable, if the function reused, the collection object will be resused and it may have incorrect values
    - Solution: <ins>default to Nono, not empty collection</ins>
    - sample:</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="err">```</span><span class="w"> </span><span class="n">python</span>
<span class="w">  </span><span class="n">def</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="err">[]</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">l</span><span class="p">.</span><span class="n">appen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">l</span>

<span class="w">  </span><span class="k">print</span><span class="p">(</span><span class="n">func</span><span class="p">())</span>
<span class="w">  </span><span class="k">print</span><span class="p">(</span><span class="n">func</span><span class="p">())</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="err">```</span>
<span class="o">-</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">recursion</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="n">#memoization</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">factorial</span><span class="w"> </span><span class="nl">example</span><span class="p">:</span>

<span class="w">      </span><span class="err">```</span><span class="w"> </span><span class="n">python</span>
<span class="w">      </span><span class="n">def</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">cache</span><span class="o">=</span><span class="err">{}</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;</span><span class="mi">1</span><span class="err">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">cache</span><span class="p">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">cache</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">        </span><span class="k">else</span><span class="err">:</span>
<span class="w">          </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<span class="w">          </span><span class="n">cache</span><span class="o">[</span><span class="n">n</span><span class="o">]=</span><span class="n">n</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">k</span>
<span class="w">      </span><span class="err">```</span>
<span class="o">-</span><span class="w"> </span><span class="k">First</span><span class="o">-</span><span class="k">Class</span><span class="w"> </span><span class="n">Functions</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">High</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="n">functions</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">arguments</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Docstring</span><span class="w"> </span><span class="n">PEP</span><span class="w"> </span><span class="mi">257</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="err">🧑‍🏫</span><span class="n">A</span><span class="w"> </span><span class="o">**</span><span class="n">docstring</span><span class="o">**</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">literal</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">^^</span><span class="k">first</span><span class="w"> </span><span class="k">statement</span><span class="o">^^</span><span class="w"> </span><span class="p">(</span><span class="n">exclude</span><span class="w"> </span><span class="n">comments</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">module</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">method</span><span class="w"> </span><span class="n">definition</span><span class="p">.</span><span class="w"> </span><span class="n">Such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">docstring</span><span class="w"> </span><span class="n">becomes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">_</span><span class="err">{</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">special</span><span class="err">}</span><span class="w"> </span><span class="n">attribute</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">object</span><span class="p">.</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">docstr</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">function</span><span class="p">.</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="n">_</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nl">Sample</span><span class="p">:</span>
</code></pre></div>

</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">root</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the pathname of the KOS root directory.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_kos_root</span>
    <span class="k">if</span> <span class="n">_kos_root</span><span class="p">:</span> <span class="k">return</span> <span class="n">_kos_root</span>
      <span class="o">...</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;function(a, b) -&gt; list&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">complex</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">imag</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Form a complex number.</span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    real -- the real part (default 0.0)</span>
<span class="sd">    imag -- the imaginary part (default 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        - Annotations PEP 3107
- 🧑‍🏫Function annotations are <ins>arbitrary python expressions</ins> that are associated with various part of functions.
- Benefit: help string(e.g. with sphinx), compile check
- it stored in <code>__annotations__</code> in K:V format
- &lt;<type hints>&gt;
    - type hints is one form of annotations
- Sample:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
  <span class="o">...</span>
<span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;a repeated &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; times&#39;</span>
  <span class="o">...</span>
</code></pre></div>
        - Lambda Expressions
- Limitations
    - single line expression
    - no assignment
    - no annotations
- Syntax</p>
<p><div class="highlight"><pre><span></span><code><span class="k">lambda</span> <span class="n">arguments</span> <span class="p">:</span> <span class="n">expression</span>

<span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">appply_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">apply_func</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="p">)</span>
</code></pre></div>
- Usages
    - use in sorted <code>key</code></p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span>```<span class="w"> </span><span class="nv">python</span>
<span class="w">  </span><span class="nv">sorted</span><span class="ss">(</span><span class="nv">d</span>,<span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">lambda</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span>:<span class="w"> </span><span class="nv">s</span>.<span class="nv">upper</span><span class="ss">())</span>
<span class="w">  </span>#<span class="w"> </span><span class="nv">randomisze</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">string</span>
<span class="w">  </span><span class="nv">sorted</span><span class="ss">(</span><span class="nv">d</span>,<span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">lambda</span><span class="w"> </span><span class="nv">x</span>:<span class="w"> </span><span class="k">random</span>.<span class="k">random</span><span class="ss">())</span>
<span class="w">  </span>```
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nv">Introspection</span>
</code></pre></div>

<ul>
<li><code>__name__</code> function name</li>
<li><code>__defaults__</code>, <code>__kwdefaults__</code> defaults values</li>
<li><code>__code__</code> the code objects includes<ul>
<li><code>co_varnames</code> : parameters</li>
<li><code>co_argcount</code></li>
</ul>
</li>
<li>&lt;<inspect>&gt; module<ul>
<li>isroutine: func or method</li>
<li>getsource | getmoudle | getcomments | signature<ul>
<li>callable</li>
</ul>
</li>
</ul>
</li>
<li>a object like (but not <em>limited to</em>) &lt;<functions>&gt; and &lt;<methods>&gt;</li>
<li><code>callable()</code> check if a object is callable</li>
<li>&lt;<Class>&gt; is callable</li>
<li>generators, coroutines, asynchronous generators</li>
<li>any objects implements <code>__call__</code> &lt;<Class>&gt;
        - {{embed(((6506c411-3211-4b0c-9647-637d211344b3)))}}
        - Partial function</li>
<li>samples:
    -
      <code>python
      from functools import partial

      # A normal function
      def f(a, b, c, x):
        return 1000*a + 100*b + 10*c + x

      # A partial function that calls f with
      # a as 3, b as 1 and c as 4.
      g = partial(f, 3, 1, 4)

      # Calling g()
      print(g(5))
      # A partial function with b = 1 and c = 2
      add_part = partial(add, c = 2, b = 1)

      # Calling partial function
      print(add_part(3))</code></li>
<li>Use<ul>
<li>Callback signature</li>
<li>Integration with other API<h3 id="-operator"><a class="toclink" href="../../../../2023/12/19/python-basic/#-operator">- Operator</a></h3>
</li>
</ul>
</li>
<li>
<h3 id="the-most-used-functions"><a class="toclink" href="../../../../2023/12/19/python-basic/#the-most-used-functions">The most used functions</a></h3>
</li>
</ul>
<table>
<thead>
<tr>
<th>Method</th>
<th>Signature</th>
<th>Behaves like</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>abs</code></td>
<td><code>abs(a)</code></td>
<td><code>abs(a)</code></td>
</tr>
<tr>
<td><code>add</code></td>
<td><code>add(a,b)</code></td>
<td>a+b</td>
</tr>
<tr>
<td><code>and_</code></td>
<td><code>and_(a,b)</code></td>
<td>a&amp;b</td>
</tr>
<tr>
<td><code>concat</code></td>
<td><code>concat(a,b)</code></td>
<td>string: a+b</td>
</tr>
<tr>
<td><code>contains</code></td>
<td><code>contains(a,b)</code></td>
<td><em>b in a</em></td>
</tr>
<tr>
<td><code>countOf</code></td>
<td><code>countOf(a,b)</code></td>
<td><code>a.count(b)</code></td>
</tr>
<tr>
<td><code>delitem</code></td>
<td><code>delitem(a,b)</code></td>
<td><code>del a[b]</code></td>
</tr>
<tr>
<td><code>delslice</code></td>
<td><code>delslice(a,b,c)</code></td>
<td><code>del/a[b:c]</code></td>
</tr>
<tr>
<td><code>div</code></td>
<td><code>div(a,b)</code></td>
<td>a/b</td>
</tr>
<tr>
<td><code>eq</code></td>
<td><code>eq(a,b)</code></td>
<td>a==b</td>
</tr>
<tr>
<td><code>floordiv</code></td>
<td><code>floordiv(a,b)</code></td>
<td>a//b</td>
</tr>
<tr>
<td><code>ge</code></td>
<td><code>ge(a,b)</code></td>
<td>a&gt;=b</td>
</tr>
<tr>
<td><code>getitem</code></td>
<td><code>getitem(a,b)</code></td>
<td><code>a[b]</code></td>
</tr>
<tr>
<td><code>getslice</code></td>
<td><code>getslice(a,b,c)</code></td>
<td><code>a[b:c]</code></td>
</tr>
<tr>
<td><code>gt</code></td>
<td><code>gt(a,b)</code></td>
<td>a&gt;b</td>
</tr>
<tr>
<td><code>indexOf</code></td>
<td><code>indexOf(a,b)</code></td>
<td><code>a.index(b)</code></td>
</tr>
<tr>
<td><code>invert, inv</code></td>
<td><code>invert(a)</code>, inv(a)</td>
<td>~a</td>
</tr>
<tr>
<td><code>is</code></td>
<td><code>is(a,b)</code></td>
<td>a is b</td>
</tr>
<tr>
<td><code>is_not</code></td>
<td><code>is_not(a,b)</code></td>
<td><em>a</em> is not <em>b</em></td>
</tr>
<tr>
<td><code>le</code></td>
<td><code>le(a,b)</code></td>
<td>a&lt;=b</td>
</tr>
<tr>
<td><code>lshift</code></td>
<td><code>lshift(a,b)</code></td>
<td>a&lt;&lt;b</td>
</tr>
<tr>
<td><code>lt</code></td>
<td><code>lt(a,b)</code></td>
<td>a&lt;b</td>
</tr>
<tr>
<td><code>mod</code></td>
<td><code>mod(a,b)</code></td>
<td>a%b</td>
</tr>
<tr>
<td><code>mul</code></td>
<td><code>mul(a,b)</code></td>
<td>a*b</td>
</tr>
<tr>
<td><code>ne</code></td>
<td><code>ne(a,b)</code></td>
<td>a!=b</td>
</tr>
<tr>
<td><code>neg</code></td>
<td><code>neg(a)</code></td>
<td>-a</td>
</tr>
<tr>
<td><code>not_</code></td>
<td><code>not_(a)</code></td>
<td><code>not a</code></td>
</tr>
<tr>
<td><code>or_</code></td>
<td><code>or_(a,b)</code></td>
<td>a</td>
</tr>
<tr>
<td><code>pos</code></td>
<td><code>pos(a)</code></td>
<td><code>+a</code></td>
</tr>
<tr>
<td><code>repeat</code></td>
<td><code>repeat(a,b)</code></td>
<td>a*b</td>
</tr>
<tr>
<td><code>rshift</code></td>
<td><code>rshift(a,b)</code></td>
<td>a&gt;&gt;b</td>
</tr>
<tr>
<td><code>setitem</code></td>
<td><code>setitem(a,b,c)</code></td>
<td>a[b]=c</td>
</tr>
<tr>
<td><code>setslice</code></td>
<td><code>setslice(a,b,c,d)</code></td>
<td>a[b:c]=d</td>
</tr>
<tr>
<td><code>sub</code></td>
<td><code>sub(a,b)</code></td>
<td>a-b</td>
</tr>
<tr>
<td><code>truediv</code></td>
<td><code>truediv(a,b)</code></td>
<td>a/b # &ldquo;true&rdquo; div -&gt; no truncation</td>
</tr>
<tr>
<td><code>truth</code></td>
<td><code>truth(a)</code></td>
<td><code>not not a, bool(a)</code></td>
</tr>
<tr>
<td><code>xor_</code></td>
<td><code>xor(a,b)</code></td>
<td>a^{ b}</td>
</tr>
<tr>
<td>- Most operator as dunder operater as well e..g. <code>le</code> <code>__le__</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>- dunder is used for object compare e.g. a&lt;b , operator used for lambda and place need a function as argument</td>
<td></td>
<td></td>
</tr>
<tr>
<td>- Samples</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><div class="highlight"><pre><span></span><code>reduce(mul, [1,2,3])  # 6
</code></pre></div>
- In-place operator
    - iadd iand iconcat ifloordiv ilshift imod imul imatual ior ipow isub ixor itruediv
- attrgetter(attr)
    - 返回一个可从操作数中获取 <em>attr</em> 的可调用对象。 如果请求了一个以上的属性，则返回一个属性元组。 属性名称还可包含点号。 例如：
        - 在 f = attrgetter(&lsquo;name&rsquo;) 之后，调用 f(b) 将返回 b.name。
        - 在 f = attrgetter(&lsquo;name&rsquo;, &lsquo;date&rsquo;) 之后，调用 f(b) 将返回 (b.name, b.date)。
        - 在 f = attrgetter(&lsquo;name.first&rsquo;, &lsquo;name.last&rsquo;) 之后，调用 f(b) 将返回 (b.name.first, b.name.last)
- <code>__getattr__</code>
    - If attr not existed in object this function will be called. e.g.  <code>obj.func_ont_exist</code> or <code>getattr(obj, 'not_existed')</code>
- <code>__getattribute__</code>
    - always triggered when reference a attribute inside a object
- itemgetter(item|*item)
    - 返回一个使用操作数的 [[<a href="https://docs.python.org/zh-cn/3/library/operator.html#operator.__getitem">https://docs.python.org/zh-cn/3/library/operator.html#operator.__getitem</a>__][]] 方法从操作数中获取 /item/ 的可调用对象。 如果指定了多个条目，则返回一个查找值的元组。
    - sample</p>
<div class="codehilite"><pre><span></span><code>  ``` python
  itemgetter(1)(&#39;ABCDEFG&#39;) #B
  itemgetter(1, 3)(&#39;ABCDEFG&#39;)  #(&#39;B&#39;, &#39;C&#39;)
  ```
</code></pre></div>

<ul>
<li>
<p>methodcaller(<em>name</em>, /, **args, ***kwargs)</p>
<ul>
<li>返回一个在操作数上调用 /name/ 方法的可调用对象。 如果给出额外的参数和/或关键字参数，它们也将被传给该方法</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">methodcaller</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">caller</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">caller</span>
<span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="n">testfun</span> <span class="o">=</span> <span class="n">attrgetter</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="n">testfun</span><span class="p">(</span><span class="s2">&quot;aaa&quot;</span><span class="p">)</span>
<span class="n">methodcaller</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;aaa&#39;</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div>
- Closure
    - Abstract
    - Questions, keywords and cues
<div class="highlight"><pre><span></span><code>:questions-keywords-cues:
          - What do I already know?
          - Strengths and weaknesses?
          - When to apply this theory?
          - How valid are the research methods?
          - How strong is the evidence?
          - How logical is the argument?
          - How does this fit in to other research in the field?
          - What do I need to find out next?

:END:
</code></pre></div>
        - When to apply this?
    -</p>
<hr />
<div class="codehilite"><pre><span></span><code>- abstract &amp; reflect
</code></pre></div>

<p><code>org
:main-idea-checkbox:
          - What is this aims?
          - What is the their research question?
          - What is the author arguing?
          - What is their answer to the question?
          - What points support their argument?
          - What are their main reasons?
          - What evidence have they used to support their argument?
          - What’s the significance of these facts?
          - What principle are they based on?
          - How can I apply them?  How do they fit in with what I already know?
          - What’s beyond them?
          - What're supporting details and explanations?

:END:</code>
        - Main points
    - 📖 Scope
        - Scopes and namespace
            - <img alt="python variable scopes" src="https://favtutor.com/resources/images/uploads/mceu_14589579711675226532035.jpg" />
            - It is important when a symbol is hide/blocked by another symbol
        - built-in scope
            - <code>print</code>, <code>True</code>, <code>False</code> etc are located in bult-in scope. If a symbol is not in <em>module</em> scope or current LEG, search in built-in scope. This is #LEGB
        - Local Scope
            - inside a function. So it also called <em>function local scope</em>
        - Enclosing Scope
            - <strong>nonlocal scope</strong>
            - <strong>nonlocal</strong>
- The <code>nonlocal</code> keyword is used in nested functions to declare that a variable refers to a variable in the nearest enclosing scope that is not global. This means if you have a nested function and you want to modify a variable from the outer (enclosing) function, you&rsquo;d use <code>nonlocal</code>. Sometime the <em>nonlocal</em> variable also been called <strong>free variable</strong>
- free variable
- Use the keyword <code>nonlocal</code> to declare that the variable is not local.
- When nonlocal can be omitted
    - if it is read after write or read only, you can skip <code>nonlocal</code> keyword
            - nested function create an outer and inner scope, use <strong>nonlocal</strong> keyword to refer to the outer scope instead of create a new local variable</p>
</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">outer</span><span class="p">():</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Favtutor&quot;</span> <span class="c1"># Local Variable</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">string</span> <span class="c1">#declaring a non local variable</span>
        <span class="n">string</span><span class="o">=</span> <span class="s2">&quot;Python Favtutor Classes&quot;</span> <span class="c1"># Overwriting value of a variable string</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inner function:&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
    <span class="n">inner</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;outer function:&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

<span class="n">outer</span><span class="p">()</span>
</code></pre></div>
        - Global scope
- A variable created in the main body of the Python code is a <strong>global</strong> variable and belongs to the global scope. aka <em>module scope</em> or <em>file scope</em>. It spans a <strong>single file</strong> only
- Global Keyword
    - If you need to create a global variable, but are stuck in the local scope, you can use the <code>global</code> keyword.
    - The <code>global</code> keyword makes the variable global.</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="err">```</span><span class="w"> </span><span class="n">python</span>
<span class="w">  </span><span class="n">def</span><span class="w"> </span><span class="n">myfunc</span><span class="p">():</span>
<span class="w">    </span><span class="n">global</span><span class="w"> </span><span class="n">x</span><span class="w">  </span><span class="c1"># create a global variable</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span>
<span class="w">  </span><span class="n">myfunc</span><span class="p">()</span>
<span class="w">  </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="err">```</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Global</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">local</span>
</code></pre></div>

<ul>
<li><strong>The main difference is that Global is used to access and modify global variables from within a function, while nonlocal is used to access and modify variables from the nearest enclosing scope that is not global.</strong></li>
<li>when python encounter a func definition at compile time. It scans for labels/var that have assigned to them <strong>anywhere</strong> in the function. If the label has not been specified as <em>global</em> it is a local</li>
<li>Var referenced but not assigned  anywhere in the func will not be local and python at runtime look for them in <strong>enclosing</strong> scopes</li>
<li>Nonlocal declarations in a local scope do not require the variable to be pre-bound (it declared in outer scope), which is another fundamental distinction between them. These variables must already have been bound in the surrounding namespace(outer function) to avoid syntax errors.</li>
<li>While a nonlocal statement allows for the alteration of an enclosing scope variable in the local scope, a global statement allows for the modification of a global variable in the local scope. Nonlocal variables must already exist, although global variables can be declared with brand-new variables.</li>
<li>Sample</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">def</span> <span class="nf">f3</span><span class="p">():</span>
  <span class="k">global</span> <span class="n">a</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># this refer to the a at line 1</span>
<span class="k">def</span> <span class="nf">f4</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># this refer to a at next line and will throw a runtime error</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">100</span>
</code></pre></div>
        - <strong>del</strong> a symbol in current scope
- e.g</p>
<p><div class="highlight"><pre><span></span><code><span class="nb">print</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">del</span> <span class="nb">print</span>
</code></pre></div>
        - Cell object
- <strong>Cell</strong> objects are used to implement variables referenced by multiple scopes. For each such variable, a cell object is created to store the value; the local variables of each stack frame that references the value contains a reference to the cells from outer scopes which also use that variable. When the value is accessed, the value contained in the cell is used instead of the cell object itself. This de-referencing of the cell object requires support from the generated byte-code; these are not automatically de-referenced when accessed. Cell objects are not likely to be useful elsewhere.
- ((650f9ddb-a02a-45cf-9524-8c395f42f66e))
- Cell is important to understand <strong>free variables</strong> used in closure
    - 📖 Closure
        - When closure created, it put the  <strong>nonlocal</strong> and <strong>global</strong> variable into a dict ((650f9d5c-c95d-41d3-8f60-6d6ada6c32f2))  and closure can be introspect with <code>__closure__</code>
        - if there is no ((65100808-8929-4581-a57b-c1f9470e4eb6)) there is no closure
        - Use closure to remember state
- ((650fb53c-bad9-4c9b-87c7-acc3a3d2a8b8))
- When counter() created a closure. It include a reference to counter/cell. So each time <code>fn()</code> called, count will change
        - Multiple instance of Closures
- Each time create a new closure, a <strong>new</strong> scope/env/capture will also created.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">f1</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="n">f1</span><span class="p">()</span> <span class="c1"># -&gt; 1</span>
<span class="n">f1</span><span class="p">()</span> <span class="c1"># -&gt; 2</span>
<span class="n">f2</span><span class="p">()</span> <span class="c1"># -&gt; 1</span>
</code></pre></div>
        - Shared scope and share reference/cell
- Following code</p>
<p><div class="highlight"><pre><span></span><code><span class="n">adders</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
  <span class="n">adders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
<span class="n">adders</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="mi">4</span>
<span class="n">adders</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="mi">4</span>
<span class="n">adders</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="mi">4</span>

<span class="c1"># vs</span>
<span class="n">adders</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
  <span class="n">adders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">n</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="n">adders</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="mi">2</span>
<span class="n">adders</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="mi">3</span>
<span class="n">adders</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>  <span class="o">-&gt;</span> <span class="mi">4</span>
</code></pre></div>
- The reason n is <strong>3</strong> for each adder closure is:
    - n is a share scope object in for loop
    - it does not recreated each time
    - each adder has a ((650f9d5c-c95d-41d3-8f60-6d6ada6c32f2)) which is reference to <code>n</code>
    - It is important to know closure scope value is stored in ((650f9d5c-c95d-41d3-8f60-6d6ada6c32f2)) and store reference, when the value reference pointing to changed, closure value will also change .
    - Python does not evaluate free vars n until adders[i] func is called. And all of then refer to same n(3) when it is called
        - Replace Class with closure
- In many cases, the only reason we might have a single-method class is to store additional state for the use in method.
- A request class</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="k">class</span> <span class="nc">SourceTemplate</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
<span class="n">github</span> <span class="o">=</span> <span class="n">SourceTemplate</span><span class="p">(</span><span class="s1">&#39;https://api.github.com/repositories?since=</span><span class="si">{since}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">github</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
- A  closure implementation</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sourcetemplete</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">load</span>
<span class="n">load</span> <span class="o">=</span> <span class="n">sourcetemplete</span><span class="p">(</span><span class="s1">&#39;https://api.github.com/repositories?since=</span><span class="si">{since}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">load</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
    - Recites
<div class="highlight"><pre><span></span><code>:howto-recite:
          Cover the notetaking column with a sheet of paper.  Then, looking at the questions or cue-words in the question and cue column only, say aloud, in your own words, the answers to the questions, facts, or ideas indicated by the cue-words.

:END:
</code></pre></div>
    -</p>
<hr />
<div class="codehilite"><pre><span></span><code>- Summary
    - main points
-
</code></pre></div>

<ul>
<li>Decorator<ul>
<li>Abstract<ul>
<li>The outer function is called the decorator, which takes the original function as an argument and returns a modified version of it.</li>
<li>So, in the most basic sense, a decorator is a callable that returns a callable.</li>
<li>((65101822-3477-4dbd-bf27-c6d41cb38579))</li>
</ul>
</li>
<li>Questions, keywords and cues
```org
:questions-keywords-cues:<ul>
<li>What do I already know?</li>
<li>Strengths and weaknesses?</li>
<li>When to apply this theory?</li>
<li>How valid are the research methods?</li>
<li>How strong is the evidence?</li>
<li>How logical is the argument?</li>
<li>How does this fit in to other research in the field?</li>
<li>What do I need to find out next?

:END:
```</li>
<li>
<h3 id="what-is-decorator"><a class="toclink" href="../../../../2023/12/19/python-basic/#what-is-decorator">What is Decorator?</a></h3>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<div class="codehilite"><pre><span></span><code>- abstract &amp; reflect
</code></pre></div>

<p><code>org
:main-idea-checkbox:
          - What is this aims?
          - What is the their research question?
          - What is the author arguing?
          - What is their answer to the question?
          - What points support their argument?
          - What are their main reasons?
          - What evidence have they used to support their argument?
          - What’s the significance of these facts?
          - What principle are they based on?
          - How can I apply them?  How do they fit in with what I already know?
          - What’s beyond them?
          - What're supporting details and explanations?

:END:</code>
        - Main points
    - 📖 Define a decorator
        - Using nested functions</p>
</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">counter</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">count</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Function </span><span class="si">{0}</span><span class="s1"> was called </span><span class="si">{1}</span><span class="s1"> times&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inner</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="s2">&quot;return sun of two integers&quot;</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">add</span> <span class="o">=</span> <span class="n">counter</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Function add was called 1 times 3</span>
</code></pre></div>
- Pythonic way</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@counter</span>
<span class="k">def</span> <span class="nf">mult</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
  <span class="s2">&quot;mult return products of three number&quot;</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span>
</code></pre></div>
- There is a minor problems that mult is no longer mult after wrapped by operator. The <code>__doc__</code> and <code>__name__</code> changed. That when <code>@wraps is needed</code></p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">counter</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">count</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> was called </span><span class="si">{1}</span><span class="s2"> times&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div>
  It is same as this:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">counter</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">count</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> was called </span><span class="si">{1}</span><span class="s2"> times&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
    <span class="n">inner</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="n">inner</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__doc__</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div>
  And also this:
  <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">counter</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">count</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> was called </span><span class="si">{1}</span><span class="s2"> times&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
    <span class="n">inner</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">fn</span><span class="p">)(</span><span class="n">inner</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div>
-
    - 📖 Decorator with parameters (Decorator factory)
- <strong>Decorator with parameters</strong> are wrapper around existing decorators. Decorator returns <strong>closure</strong> but <strong>decorator with parameters</strong> returns decorator.
- A timer decorator with parameters</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># name factory is decorator factory which accepts parameters</span>
<span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
  <span class="c1"># name timer is actual decorator</span>
    <span class="k">def</span> <span class="nf">timer</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">perf_counter</span>

      <span class="c1"># name inner is closure</span>
        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">total_time</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
                <span class="n">to_execute</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">end_time</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
                <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
                <span class="n">total_time</span> <span class="o">+=</span> <span class="n">execution_time</span>
            <span class="n">average_time</span> <span class="o">=</span> <span class="n">total_time</span><span class="o">/</span><span class="n">number</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> took </span><span class="si">{1:.8f}</span><span class="s1">s on an average to execute (tested for </span><span class="si">{2}</span><span class="s1"> times)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">execution_time</span><span class="p">,</span> <span class="n">number</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">to_execute</span>

        <span class="k">return</span> <span class="n">inner</span>
    <span class="k">return</span> <span class="n">timer</span>

<span class="nd">@factory</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">function_1</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="nd">@factory</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">function_2</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000000</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="n">function_1</span><span class="p">()</span>
<span class="n">function_2</span><span class="p">()</span>
</code></pre></div>
    - Recites
<div class="highlight"><pre><span></span><code>:howto-recite:
          Cover the notetaking column with a sheet of paper.  Then, looking at the questions or cue-words in the question and cue column only, say aloud, in your own words, the answers to the questions, facts, or ideas indicated by the cue-words.

:END:
</code></pre></div>
    -</p>
<hr />
<div class="codehilite"><pre><span></span><code>- Summary
</code></pre></div>

<h3 id="-main-points"><a class="toclink" href="../../../../2023/12/19/python-basic/#-main-points">- main points</a></h3>
<ul>
<li>Tuple<ul>
<li>
<h2 id="wired-fact-tuple-is-not-created-with-it-is-with"><a class="toclink" href="../../../../2023/12/19/python-basic/#wired-fact-tuple-is-not-created-with-it-is-with">[[wired fact]] tuple is not created with <code>()</code> it is with <code>,</code></a></h2>
</li>
</ul>
</li>
<li><code>(1)</code> is not a tuple, it is a int, a single int of 1</li>
<li><code>1,</code> is a tuple</li>
<li><code>1, 2, 3</code> is a tuple</li>
<li><code>()</code> is used just to make code looks nicer</li>
<li>create a empty tuple using <code>tuple()</code>, <code>()</code> will do as well<ul>
<li>Pack and unpack</li>
</ul>
</li>
<li>Similar to ((650504dd-7dea-4c1a-9a18-71aa0e1f2200))</li>
<li><code>a, b, c = 1, 2, 3</code>; <code>a, b, c = [1, 2, 3]</code>; <code>(a, b, c) = [1, 2, 3]</code> they works the same way</li>
<li>behind the scenes: a, b, c is a <code>tuple</code></li>
<li><code>a, b, c = 'XYZ'</code>   <code>a='X', b='Y', c='Z'</code></li>
<li><code>for e in 12, 10, 'hello'</code></li>
<li>
<h3 id="swap-a-b-b-a"><a class="toclink" href="../../../../2023/12/19/python-basic/#swap-a-b-b-a">swap: <code>a, b = b, a</code></a></h3>
<code>python
  d = {'1': 1, '2':2}
  a, b = d # a can be '1' or '2'</code></li>
<li>
<p>extended unpack with <code>*</code> and <code>**</code>
    -
      <code>python
      a, *b = [1, 2, 3] # a=1, b = [2, 3]
      a, *b = 'XYZ' #b=['Y', 'Z']
      a, *b, c = 'abcd'  # b=['b', 'c']</code></p>
<ul>
<li>unpack can be used other way around</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="n">l1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">l2</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="o">*</span><span class="n">l2</span><span class="p">]</span>  <span class="c1"># 1, 2, 3, 4</span>
<span class="n">l3</span> <span class="o">=</span> <span class="s1">&#39;XYZ&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="o">*</span><span class="n">l3</span><span class="p">]</span> <span class="c1"># [1, 2, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;]</span>
</code></pre></div>
- unpack dict with <code>**</code>
    - merge dict</p>
<div class="codehilite"><pre><span></span><code>  ``` python
  d1={1:1}
  d2={1:1, 2:2}
  d3={1:2: 3:3}
  d = {**d1, **d, **d3}  # duplicated value will be overwrote
  ```
</code></pre></div>

<ul>
<li>nested unpacking</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">]</span> <span class="c1"># b = [2, 3], c = X ...</span>
</code></pre></div>
- Ignore some of fields when unpack</p>
<p><div class="highlight"><pre><span></span><code><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>   <span class="c1"># -&gt; c = 5</span>
<span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">ignore</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>   <span class="c1"># -&gt; c = 5</span>
</code></pre></div>
    - Named Tuple
        - namedtuple is a <strong>class factory</strong> return a subclass of tuple.  You need a class_{ name} and array of element names to create it. The name can also be a string of space <code></code> or <code>,</code> separated words
          Syntax:</p>
</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="n">TupleClass</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">])</span>
<span class="n">TupleClass</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span>  <span class="s1">&#39;string of names&#39;</span><span class="p">)</span>
<span class="c1"># Sample</span>
<span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Point&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="c1"># Now Point is a class</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
- Name tuple is tuple so it can use all tuple operations</p>
<p><div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Point</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
- Extend a tuple</p>
<p><div class="highlight"><pre><span></span><code><span class="n">Point1D</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Point1D&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">fields</span> <span class="o">=</span> <span class="n">Point1D</span><span class="o">.</span><span class="n">_field</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,)</span>
<span class="n">Point1D</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Point2D&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</code></pre></div>
    - Optimization
- Object Interning In Python
    - Object interning is a technique used in Python to optimize memory usage and improve performance by reusing immutable objects instead of creating new instances. It is particularly useful for strings, integers and user-defined objects. By interning objects, Python can store only one copy of each distinct object in memory reducing memory consumption and speeding up operations that rely on object comparisons.
    - Syntax:
      <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">interned_string</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">intern</span><span class="p">(</span><span class="err">“</span><span class="n">string_to_intern</span><span class="err">”</span><span class="p">)</span>
<span class="n">interned_string2</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">intern</span><span class="p">(</span><span class="err">“</span><span class="n">string_to_intern</span><span class="err">”</span><span class="p">)</span>
<span class="n">interned_string</span> <span class="ow">is</span> <span class="n">interned_string2</span> <span class="c1"># faster than str cmp</span>
</code></pre></div>
    - All identifiers are interned
- Peephole
    - In Peephole optimization, Python optimizes code either by <strong>pre-calculating</strong> constant expressions or by <strong>membership tests</strong> (converting mutable data structures to immutable data structures.)
    - <a href="https://www.codesansar.com/python-programming/peephole-optimization.htm">Peephole Optimization in Python</a>
    - Find what is pre-calculation by using
      <code>your_obj.__code__.co_consts</code>
    -
-
-
-
-</p>
</li>
</ul>
</li>
</ul>
    <nav class="md-post__action">
      <a href="../../../../2023/12/19/python-basic/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2023-12-19 00:00:00">December 19, 2023</time>
          <!-- start customization -->
          
          <!-- end customization --></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="python-fundamental"><a class="toclink" href="../../../../2023/12/19/python-fundamental/">Python Fundamental</a></h2>
<details>
  <summary><h2>string.strip()</h2></summary>

  ### Usage
  1. remove all empty
  2. it allows arguments e.g. \'abbabbacdef\'.strip(\'ab\'). it remove both `a` and `b` (the sequence does not matter)

  ### exampls
  <div class="highlight"><pre><span></span><code><span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;   aaa </span><span class="se">\n</span><span class="s2"> &quot;</span><span class="p">)</span>
</code></pre></div>
</details>

<details>
  <summary><h2>calculate total of 1\~100 #card</h2></summary>

  ### Usage
    1. sum and range
  ### exampls
  <div class="highlight"><pre><span></span><code><span class="nb">sum</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</code></pre></div>
</details>

<h3 id="sumrange1-100"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#sumrange1-100">sum(range(1, 100))</a></h3>
<h2 id="remove-key-from-dict-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#remove-key-from-dict-card">remove 'key' from dict #card</a></h2>
<h3 id="del-dictkey"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#del-dictkey">del dict['key']</a></h3>
<h2 id="merge-two-dict-dict1-and-dict2-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#merge-two-dict-dict1-and-dict2-card">merge two dict， dict1 and dict2 #card</a></h2>
<h3 id="dict1updatedict2"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#dict1updatedict2">dict1.update(dict2)</a></h3>
<h2 id="deduplicate-from-a-list-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#deduplicate-from-a-list-card">deduplicate from a list #card</a></h2>
<h3 id="use-set"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#use-set">use set</a></h3>
<p><code>list(set(mylist))</code> **</p>
<h2 id="args-and-kwargs-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#args-and-kwargs-card"><code>*args</code> and <code>**kwargs</code> #card</a></h2>
<h3 id="args-positional-arguments"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#args-positional-arguments">args: positional arguments</a></h3>
<h3 id="kwargs-kv-arguments-dict"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#kwargs-kv-arguments-dict">kwargs: kv arguments (dict)</a></h3>
<h2 id="what-is-dectorator-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#what-is-dectorator-card">What is dectorator #card</a></h2>
<h3 id="a-function-return-function-and-the-argument-is-a-function"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#a-function-return-function-and-the-argument-is-a-function">a function return function and the argument is a function</a></h3>
<h2 id="difference-between-__init__-and-__new__-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#difference-between-__init__-and-__new__-card">difference between <code>__init__</code> and <code>__new__</code> #card</a></h2>
<h3 id="__init__-first-arg-is-self"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#__init__-first-arg-is-self"><code>__init__</code> 是初始化方法，创建对象后，就立刻被默认调用了，可接收参数, first arg is <code>self</code></a></h3>
<h3 id="__new__-take-cls-which-is-current-class-it-need-to-return-the-new-class"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#__new__-take-cls-which-is-current-class-it-need-to-return-the-new-class"><code>__new__</code> take <code>cls</code> which is current class. It need to return the new class</a></h3>
<h2 id="with-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#with-card"><code>with</code> #card</a></h2>
<h3 id="it-implement-finally-fileclose"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#it-implement-finally-fileclose">it implement <code>finally: file.close()</code></a></h3>
<h2 id="12345-1491625-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#12345-1491625-card">[1,2,3,4,5] -&gt; [1,4,9,16,25] #card</a></h2>
<h3 id="list-comprehension-ii-for-i-in-l"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#list-comprehension-ii-for-i-in-l">list comprehension: [i*i for i in l]</a></h3>
<h3 id="map-maplambda-x-xx-12345"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#map-maplambda-x-xx-12345">map: map(lambda x: x*x, [1,2,3,4,5])</a></h3>
<h2 id="sabccba-deduplicate-and-sort-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#sabccba-deduplicate-and-sort-card">s='abccba' deduplicate and sort #card</a></h2>
<h3 id="joinsortedlistsets"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#joinsortedlistsets"><code>''.join(sorted(list(set(s)))</code></a></h3>
<h2 id="what-is-difference-between-remove-discard-del-and-pop-when-remove-a-element-from-a-list-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#what-is-difference-between-remove-discard-del-and-pop-when-remove-a-element-from-a-list-card">What is difference between <code>remove</code> , <code>discard</code>, <code>del</code> and <code>pop</code> when remove a element from a list #card</a></h2>
<h3 id="removev-remove-first-element-with-value-v"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#removev-remove-first-element-with-value-v"><code>remove(v)</code> remove first element with value v</a></h3>
<h3 id="del-l2-remove-element-from-l-at-pos-2"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#del-l2-remove-element-from-l-at-pos-2">del l[2] remove element from l at pos 2</a></h3>
<h3 id="popidx-1"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#popidx-1">pop(idx=-1)</a></h3>
<h3 id="discard-does-not-raise-exception-when-key-not-existed"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#discard-does-not-raise-exception-when-key-not-existed">discard does not raise exception when key not existed</a></h3>
<h2 id="sort-a-dict-based-on-key-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#sort-a-dict-based-on-key-card">Sort a dict based on key #card</a></h2>
<h3 id="sorteddictitems-keylambda-i-i0-reversefalse"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#sorteddictitems-keylambda-i-i0-reversefalse"><code>sorted(dict.items(),  key=lambda i: i[0], reverse=False)</code></a></h3>
<h2 id="find-all-odd-number-in-a-list-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#find-all-odd-number-in-a-list-card">find all odd number in a list #card</a></h2>
<h3 id="list-comprehension-i-for-i-in-l-if-i21"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#list-comprehension-i-for-i-in-l-if-i21">list comprehension [i for i in l if i%2==1]</a></h3>
<h3 id="filter-filterlambda-i-i21-1234"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#filter-filterlambda-i-i21-1234">filter(): filter(lambda i i%2==1, [1,2,3,4])</a></h3>
<h2 id="merge-two-list-l1-l2-and-sort-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#merge-two-list-l1-l2-and-sort-card">merge two list l1, l2 and sort #card</a></h2>
<h3 id="l1extendl2-sortedl1"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#l1extendl2-sortedl1"><code>l1.extend(l2); sorted(l1)</code></a></h3>
<h2 id="a1-2-3-4-1234-card"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#a1-2-3-4-1234-card"><code>a=[[1, 2], [3, 4]]</code> -&gt; [1,2,3,4] #card</a></h2>
<h3 id="two-steps-j-for-i-in-a-for-j-in-i-for-i-in-a-each-i-is-1-2-3-4-for-j-in-i-12-3-4"><a class="toclink" href="../../../../2023/12/19/python-fundamental/#two-steps-j-for-i-in-a-for-j-in-i-for-i-in-a-each-i-is-1-2-3-4-for-j-in-i-12-3-4">two steps <code>[ j for i in a for j in i  ]</code> ~for i in a ~ each i is [1, 2], [3, 4]; for j in i -&gt; 1,2 3, 4</a></h3>
<p>**</p>
    <nav class="md-post__action">
      <a href="../../../../2023/12/19/python-fundamental/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__current">2</span>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019 - 2024 RayX
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ray-x" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/x_II_x" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/ray-x" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": [], "search": "../../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "tags": {"CSS": "css", "HTML": "html", "JavaScript": "js"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>